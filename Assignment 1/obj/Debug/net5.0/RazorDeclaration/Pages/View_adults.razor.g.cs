// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace Assignment_1.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using Assignment_1;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\_Imports.razor"
using Assignment_1.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\Pages\View_adults.razor"
using FileData;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\Pages\View_adults.razor"
using Microsoft.AspNetCore.Mvc.ModelBinding.Binders;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\Pages\View_adults.razor"
using Microsoft.Extensions.DependencyInjection;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\Pages\View_adults.razor"
using Models;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/view_adults")]
    public partial class View_adults : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 127 "C:\Users\simon\RiderProjects\Assignment 1\Assignment 1\Pages\View_adults.razor"
       
    private string nameSearch = "";
    private string jobSearch = "";
    private string gender = "any";
    private string ageFilter = "all";
    private int age = 0;
    private string heightFilter = "all";
    private int height = 0;
    private string weightFilter = "all";
    private int weight = 0;
    private string salaryFilter = "all";
    private int salary = 0;
    private string eyeFilter = "all";
    private string hairFilter = "all";
    private IList<String> eyeColors = new List<String>();
    private IList<String> hairColors = new List<String>();

    private bool hideInfo = true;
    private readonly string HeaderStyle = "text-shadow:0px 0px 2px black; background-color: #d1d1d1;";
    private IList<Adult> adults = new List<Adult>();

    private string infoText = "No adult selected";
    
    IFileContext fc = new FileContext();

    protected override async Task OnInitializedAsync()
    {
        Start();
    }
    
    public void Start()
    {
        if (TheUser.UserName == null)
        {
            Console.WriteLine("User is null! Navigating to login...");

            NavigationManager.NavigateTo("/login");
        }
        else
        {
            adults = fc.Adults;
            SetDropDowns(adults);
        }
    }

    public void SetDropDowns(IList<Adult> adultList)
    {
        foreach (var adult in adultList)
        {
            if (!eyeColors.Contains(adult.EyeColor))
            {
                eyeColors.Add(adult.EyeColor);
            }
            if (!hairColors.Contains(adult.HairColor))
            {
                hairColors.Add(adult.HairColor);
            }
        }
    }

    public void HideInfo()
    {
        hideInfo = true;
        infoText = "";
    }

    public void ShowInfo(Adult adult)
    {
        String infoToShow = BuildInfoText(adult);
        if (!infoText.Equals(infoToShow))
        {
            infoText = infoToShow;
            hideInfo = false;
        }
        else
        {
            hideInfo = true;
            infoText = "No adult selected";
        }
    }

    public string BuildInfoText(Adult adult)
    {
        string str = "Info for '" + adult.FirstName + " " + adult.LastName + "':\n\n";

        str += "ID: " + adult.Id + "\n";
        str += "First name: " + adult.FirstName + "\n";
        str += "Last name: " + adult.LastName + "\n";
        str += "Age: " + adult.Age + "\n";
        str += "Sex: " + adult.Sex + "\n";
        str += "Height: " + adult.Height + "\n";
        str += "Weight: " + adult.Weight + "\n";
        str += "Hair color: " + adult.HairColor + "\n";
        str += "Eye color: " + adult.EyeColor + "\n";
        str += "Job title: " + adult.JobTitle.JobTitle + "\n";
        str += "Salary: " + adult.JobTitle.Salary + "\n";

        return str;
    }

    public void Search()
    {
        IList<Adult> allAdults = fc.Adults;

    IList<Adult> tempAdults = new List<Adult>();

        // We check filters
        foreach (var adult in allAdults)
        {
            bool passes = true;
    // Name
                if (!(adult.FirstName.ToLower().Contains(nameSearch.ToLower()) || adult.LastName.ToLower().Contains(nameSearch.ToLower()) || (adult.FirstName + " " + adult.LastName).ToLower().Contains(nameSearch.ToLower())))
                {
                    passes = false;
                    continue;
                }
                else
                {
    // Job
                    if (!(adult.JobTitle.JobTitle.Equals("") || adult.JobTitle.JobTitle.ToLower().Contains(jobSearch.ToLower())))
                    {
                        passes = false;
                        continue;
                    }
                    else
                    {
    // Gender
                        if (!(adult.Sex.Equals(gender) || gender.Equals("any")))
                        {
                            passes = false;
                            continue;
                        }
                        else
                        {
    // Age
                            if (!(ageFilter.Equals("all")))
                            {
                                if (ageFilter.Equals("above") && adult.Age < age)
                                {
                                    passes = false;
                                    continue;
                                }
                                else if (ageFilter.Equals("below") && adult.Age > age)
                                {
                                    passes = false;
                                    continue;
                                }
                            }
    // Height
                                if (!(heightFilter.Equals("all")))
                                {
                                    if (heightFilter.Equals("above") && adult.Height < height)
                                    {
                                        passes = false;
                                        continue;
                                    }
                                    else if (heightFilter.Equals("below") && adult.Height > height)
                                    {
                                        passes = false;
                                        continue;
                                    }
                                }
    // Weight
                                    if (!(weightFilter.Equals("all")))
                                    {
                                        if (weightFilter.Equals("above") && adult.Weight < weight)
                                        {
                                            passes = false;
                                            continue;
                                        }
                                        else if (weightFilter.Equals("below") && adult.Weight > weight)
                                        {
                                            passes = false;
                                            continue;
                                        }
                                    }
                            
    // Salary
                            if (!(salaryFilter.Equals("all")))
                            {
                                if (salaryFilter.Equals("above") && adult.JobTitle.Salary < salary)
                                {
                                    passes = false;
                                    continue;
                                }
                                else if (salaryFilter.Equals("below") && adult.JobTitle.Salary > salary)
                                {
                                    passes = false;
                                    continue;
                                }
                            }
                            // Eyes
                            if (!(adult.EyeColor.Equals(eyeFilter) || eyeFilter.Equals("all")))
                            {
                                passes = false;
                                continue;
                            }
                            // Hair
                            if (!(adult.HairColor.Equals(hairFilter) || hairFilter.Equals("all")))
                            {
                                passes = false;
                                continue;
                            }
                                }
                            }
                        }
            if (passes)
                {
                    Console.WriteLine(adult.FirstName + " passes filters!");
                    tempAdults.Add(adult);
                }
            }
        adults = tempAdults;
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavigationManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private User TheUser { get; set; }
    }
}
#pragma warning restore 1591
